#!/usr/bin/env node

var argv = require('optimist').argv;
var server = require('../crud-file-server');

if(!argv.q) {=
	console.log('  CRUD-file-server [args]');
	console.log('');
	console.log('Iniciando CRUD');
	console.log('');
	console.log('  -f URL do sistema');
	console.log('  -h requisicao de log');
	console.log('  -p porta');
	console.log('  -r apenas leitura');
	console.log('  -v path virtual para o host');
	console.log('');
	console.log('example:');
	console.log('');
	console.log('  crud-file-server -f c:/ -p 8080 -q -v filez');
	console.log('');
}

var port  = argv.p || 8080;
var path  = argv.f || process.cwd();
var vpath = (argv.v || '').trimLeft();
var readOnly = argv.r;
var logHeadRequests = argv.h;

require('http').createServer(function (req, res) {
	server.handleRequest(vpath, path, req, res, readOnly, logHeadRequests);
}).listen(port);

console.log('porta :' + port + '/' + vpath + path);
